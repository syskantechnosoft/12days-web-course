<%- include('partials/header', { title: title }) %>

<article class="post-detail">
  <h1 class="post-title"><%= post.title %></h1>
  
  <div class="post-meta">
    <span class="author">By <%= post.author %></span>
    <span class="date"><%= post.createdAt.toLocaleDateString('en-US', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    }) %></span>
    <span class="likes">‚ù§Ô∏è <%= post.likes %> likes</span>
  </div>
  
  <div class="post-content">
    <%= post.content %>
  </div>
  
  <div class="post-actions">
    <button class="btn btn-primary" onclick="likePost(<%= post.id %>)">
      ‚ù§Ô∏è Like (<%= post.likes %>)
    </button>
    <button class="btn btn-danger" onclick="deletePost(<%= post.id %>)">
      üóëÔ∏è Delete
    </button>
    <a href="/" class="btn btn-secondary">‚Üê Back to Home</a>
  </div>
</article>

<script>
  async function likePost(postId) {
    try {
      const response = await fetch(`/api/posts/${postId}/like`, {
        method: 'PATCH'
      });
      
      const data = await response.json();
      
      if (response.ok) {
        alert(`Post liked! Total likes: ${data.likes}`);
        location.reload();
      }
    } catch (error) {
      alert('Error liking post');
    }
  }
  
  async function deletePost(postId) {
    if (!confirm('Are you sure you want to delete this post?')) {
      return;
    }
    
    try {
      const response = await fetch(`/api/posts/${postId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        alert('Post deleted successfully');
        window.location.href = '/';
      }
    } catch (error) {
      alert('Error deleting post');
    }
  }
</script>

<%- include('partials/footer') %>
